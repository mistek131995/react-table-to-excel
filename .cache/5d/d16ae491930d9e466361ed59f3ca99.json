{"id":"../node_modules/exceljs/dist/es5/utils/shared-formula.js","dependencies":[{"name":"C:\\Users\\omega\\OneDrive\\Рабочий стол\\ReactApp\\react-table-to-excel\\node_modules\\exceljs\\dist\\es5\\utils\\shared-formula.js.map","includedInParent":true,"mtime":1658855091255},{"name":"C:\\Users\\omega\\OneDrive\\Рабочий стол\\ReactApp\\react-table-to-excel\\package.json","includedInParent":true,"mtime":1658855091654},{"name":"C:\\Users\\omega\\OneDrive\\Рабочий стол\\ReactApp\\react-table-to-excel\\node_modules\\exceljs\\package.json","includedInParent":true,"mtime":1658855090910},{"name":"./col-cache","loc":{"line":3,"column":23,"index":38},"parent":"C:\\Users\\omega\\OneDrive\\Рабочий стол\\ReactApp\\react-table-to-excel\\node_modules\\exceljs\\dist\\es5\\utils\\shared-formula.js","resolved":"C:\\Users\\omega\\OneDrive\\Рабочий стол\\ReactApp\\react-table-to-excel\\node_modules\\exceljs\\dist\\es5\\utils\\col-cache.js"}],"generated":{"js":"\"use strict\";\n\nvar colCache = require('./col-cache'); // const cellRefRegex = /(([a-z_\\-0-9]*)!)?[$]?([a-z]+)[$]?([1-9][0-9]*)/i;\n\n\nvar replacementCandidateRx = /(([a-z_\\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi;\nvar CRrx = /^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;\n\nfunction slideFormula(formula, fromCell, toCell) {\n  var offset = colCache.decode(fromCell);\n  var to = colCache.decode(toCell);\n  return formula.replace(replacementCandidateRx, function (refMatch, sheet, sheetMaybe, addrPart, trailingParen) {\n    if (trailingParen) {\n      return refMatch;\n    }\n\n    var match = CRrx.exec(addrPart);\n\n    if (match) {\n      var colDollar = match[1];\n      var colStr = match[2].toUpperCase();\n      var rowDollar = match[3];\n      var rowStr = match[4];\n\n      if (colStr.length > 3 || colStr.length === 3 && colStr > 'XFD') {\n        // > XFD is the highest col number in excel 2007 and beyond, so this is a named range\n        return refMatch;\n      }\n\n      var col = colCache.l2n(colStr);\n      var row = parseInt(rowStr, 10);\n\n      if (!colDollar) {\n        col += to.col - offset.col;\n      }\n\n      if (!rowDollar) {\n        row += to.row - offset.row;\n      }\n\n      var res = (sheet || '') + (colDollar || '') + colCache.n2l(col) + (rowDollar || '') + row;\n      return res;\n    }\n\n    return refMatch;\n  });\n}\n\nmodule.exports = {\n  slideFormula: slideFormula\n};"},"sourceMaps":{"js":{"mappings":[{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":1,"column":0},"generated":{"line":3,"column":0}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":1,"column":6},"generated":{"line":3,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":1,"column":14},"generated":{"line":3,"column":12}},{"source":"../../../lib/utils/shared-formula.js","name":"require","original":{"line":1,"column":17},"generated":{"line":3,"column":15}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":1,"column":24},"generated":{"line":3,"column":22}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":1,"column":25},"generated":{"line":3,"column":23}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":1,"column":24},"generated":{"line":3,"column":36}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":1,"column":0},"generated":{"line":3,"column":37}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":3,"column":0},"generated":{"line":3,"column":39}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":4,"column":0},"generated":{"line":6,"column":0}},{"source":"../../../lib/utils/shared-formula.js","name":"replacementCandidateRx","original":{"line":4,"column":6},"generated":{"line":6,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":4,"column":28},"generated":{"line":6,"column":26}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":4,"column":31},"generated":{"line":6,"column":29}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":4,"column":0},"generated":{"line":6,"column":73}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":5,"column":0},"generated":{"line":7,"column":0}},{"source":"../../../lib/utils/shared-formula.js","name":"CRrx","original":{"line":5,"column":6},"generated":{"line":7,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":5,"column":10},"generated":{"line":7,"column":8}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":5,"column":13},"generated":{"line":7,"column":11}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":5,"column":0},"generated":{"line":7,"column":49}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":7,"column":0},"generated":{"line":9,"column":0}},{"source":"../../../lib/utils/shared-formula.js","name":"slideFormula","original":{"line":7,"column":9},"generated":{"line":9,"column":9}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":7,"column":0},"generated":{"line":9,"column":21}},{"source":"../../../lib/utils/shared-formula.js","name":"formula","original":{"line":7,"column":22},"generated":{"line":9,"column":22}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":7,"column":0},"generated":{"line":9,"column":29}},{"source":"../../../lib/utils/shared-formula.js","name":"fromCell","original":{"line":7,"column":31},"generated":{"line":9,"column":31}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":7,"column":0},"generated":{"line":9,"column":39}},{"source":"../../../lib/utils/shared-formula.js","name":"toCell","original":{"line":7,"column":41},"generated":{"line":9,"column":41}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":7,"column":0},"generated":{"line":9,"column":47}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":7,"column":49},"generated":{"line":9,"column":49}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":8,"column":2},"generated":{"line":10,"column":2}},{"source":"../../../lib/utils/shared-formula.js","name":"offset","original":{"line":8,"column":8},"generated":{"line":10,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":8,"column":14},"generated":{"line":10,"column":12}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":8,"column":17},"generated":{"line":10,"column":15}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":8,"column":25},"generated":{"line":10,"column":23}},{"source":"../../../lib/utils/shared-formula.js","name":"decode","original":{"line":8,"column":26},"generated":{"line":10,"column":24}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":8,"column":17},"generated":{"line":10,"column":30}},{"source":"../../../lib/utils/shared-formula.js","name":"fromCell","original":{"line":8,"column":33},"generated":{"line":10,"column":31}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":8,"column":17},"generated":{"line":10,"column":39}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":8,"column":2},"generated":{"line":10,"column":40}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":9,"column":2},"generated":{"line":11,"column":2}},{"source":"../../../lib/utils/shared-formula.js","name":"to","original":{"line":9,"column":8},"generated":{"line":11,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":9,"column":10},"generated":{"line":11,"column":8}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":9,"column":13},"generated":{"line":11,"column":11}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":9,"column":21},"generated":{"line":11,"column":19}},{"source":"../../../lib/utils/shared-formula.js","name":"decode","original":{"line":9,"column":22},"generated":{"line":11,"column":20}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":9,"column":13},"generated":{"line":11,"column":26}},{"source":"../../../lib/utils/shared-formula.js","name":"toCell","original":{"line":9,"column":29},"generated":{"line":11,"column":27}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":9,"column":13},"generated":{"line":11,"column":33}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":9,"column":2},"generated":{"line":11,"column":34}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":10,"column":2},"generated":{"line":12,"column":2}},{"source":"../../../lib/utils/shared-formula.js","name":"formula","original":{"line":10,"column":9},"generated":{"line":12,"column":9}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":10,"column":16},"generated":{"line":12,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":"replace","original":{"line":10,"column":17},"generated":{"line":12,"column":17}},{"source":"../../../lib/utils/shared-formula.js","name":"formula","original":{"line":10,"column":9},"generated":{"line":12,"column":24}},{"source":"../../../lib/utils/shared-formula.js","name":"replacementCandidateRx","original":{"line":11,"column":4},"generated":{"line":12,"column":25}},{"source":"../../../lib/utils/shared-formula.js","name":"formula","original":{"line":10,"column":9},"generated":{"line":12,"column":47}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":12,"column":4},"generated":{"line":12,"column":49}},{"source":"../../../lib/utils/shared-formula.js","name":"refMatch","original":{"line":12,"column":5},"generated":{"line":12,"column":59}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":12,"column":4},"generated":{"line":12,"column":67}},{"source":"../../../lib/utils/shared-formula.js","name":"sheet","original":{"line":12,"column":15},"generated":{"line":12,"column":69}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":12,"column":4},"generated":{"line":12,"column":74}},{"source":"../../../lib/utils/shared-formula.js","name":"sheetMaybe","original":{"line":12,"column":22},"generated":{"line":12,"column":76}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":12,"column":4},"generated":{"line":12,"column":86}},{"source":"../../../lib/utils/shared-formula.js","name":"addrPart","original":{"line":12,"column":34},"generated":{"line":12,"column":88}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":12,"column":4},"generated":{"line":12,"column":96}},{"source":"../../../lib/utils/shared-formula.js","name":"trailingParen","original":{"line":12,"column":44},"generated":{"line":12,"column":98}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":12,"column":4},"generated":{"line":12,"column":111}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":12,"column":62},"generated":{"line":12,"column":113}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":13,"column":6},"generated":{"line":13,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":"trailingParen","original":{"line":13,"column":10},"generated":{"line":13,"column":8}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":13,"column":6},"generated":{"line":13,"column":21}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":13,"column":25},"generated":{"line":13,"column":23}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":14,"column":8},"generated":{"line":14,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"refMatch","original":{"line":14,"column":15},"generated":{"line":14,"column":13}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":14,"column":8},"generated":{"line":14,"column":21}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":15,"column":7},"generated":{"line":15,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":16,"column":6},"generated":{"line":17,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":"match","original":{"line":16,"column":12},"generated":{"line":17,"column":8}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":16,"column":17},"generated":{"line":17,"column":13}},{"source":"../../../lib/utils/shared-formula.js","name":"CRrx","original":{"line":16,"column":20},"generated":{"line":17,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":16,"column":24},"generated":{"line":17,"column":20}},{"source":"../../../lib/utils/shared-formula.js","name":"exec","original":{"line":16,"column":25},"generated":{"line":17,"column":21}},{"source":"../../../lib/utils/shared-formula.js","name":"CRrx","original":{"line":16,"column":20},"generated":{"line":17,"column":25}},{"source":"../../../lib/utils/shared-formula.js","name":"addrPart","original":{"line":16,"column":30},"generated":{"line":17,"column":26}},{"source":"../../../lib/utils/shared-formula.js","name":"CRrx","original":{"line":16,"column":20},"generated":{"line":17,"column":34}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":16,"column":6},"generated":{"line":17,"column":35}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":17,"column":6},"generated":{"line":19,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":"match","original":{"line":17,"column":10},"generated":{"line":19,"column":8}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":17,"column":6},"generated":{"line":19,"column":13}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":17,"column":17},"generated":{"line":19,"column":15}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":18,"column":8},"generated":{"line":20,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"colDollar","original":{"line":18,"column":14},"generated":{"line":20,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":18,"column":23},"generated":{"line":20,"column":19}},{"source":"../../../lib/utils/shared-formula.js","name":"match","original":{"line":18,"column":26},"generated":{"line":20,"column":22}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":18,"column":31},"generated":{"line":20,"column":27}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":18,"column":32},"generated":{"line":20,"column":28}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":18,"column":31},"generated":{"line":20,"column":29}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":18,"column":8},"generated":{"line":20,"column":30}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":19,"column":8},"generated":{"line":21,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"colStr","original":{"line":19,"column":14},"generated":{"line":21,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":19,"column":20},"generated":{"line":21,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":"match","original":{"line":19,"column":23},"generated":{"line":21,"column":19}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":19,"column":28},"generated":{"line":21,"column":24}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":19,"column":29},"generated":{"line":21,"column":25}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":19,"column":28},"generated":{"line":21,"column":26}},{"source":"../../../lib/utils/shared-formula.js","name":"match","original":{"line":19,"column":23},"generated":{"line":21,"column":27}},{"source":"../../../lib/utils/shared-formula.js","name":"toUpperCase","original":{"line":19,"column":32},"generated":{"line":21,"column":28}},{"source":"../../../lib/utils/shared-formula.js","name":"match","original":{"line":19,"column":23},"generated":{"line":21,"column":39}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":19,"column":8},"generated":{"line":21,"column":41}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":20,"column":8},"generated":{"line":22,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"rowDollar","original":{"line":20,"column":14},"generated":{"line":22,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":20,"column":23},"generated":{"line":22,"column":19}},{"source":"../../../lib/utils/shared-formula.js","name":"match","original":{"line":20,"column":26},"generated":{"line":22,"column":22}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":20,"column":31},"generated":{"line":22,"column":27}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":20,"column":32},"generated":{"line":22,"column":28}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":20,"column":31},"generated":{"line":22,"column":29}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":20,"column":8},"generated":{"line":22,"column":30}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":21,"column":8},"generated":{"line":23,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"rowStr","original":{"line":21,"column":14},"generated":{"line":23,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":21,"column":20},"generated":{"line":23,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":"match","original":{"line":21,"column":23},"generated":{"line":23,"column":19}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":21,"column":28},"generated":{"line":23,"column":24}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":21,"column":29},"generated":{"line":23,"column":25}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":21,"column":28},"generated":{"line":23,"column":26}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":21,"column":8},"generated":{"line":23,"column":27}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":22,"column":8},"generated":{"line":25,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"colStr","original":{"line":22,"column":12},"generated":{"line":25,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":22,"column":18},"generated":{"line":25,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":"length","original":{"line":22,"column":19},"generated":{"line":25,"column":17}},{"source":"../../../lib/utils/shared-formula.js","name":"colStr","original":{"line":22,"column":12},"generated":{"line":25,"column":23}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":22,"column":28},"generated":{"line":25,"column":26}},{"source":"../../../lib/utils/shared-formula.js","name":"colStr","original":{"line":22,"column":12},"generated":{"line":25,"column":27}},{"source":"../../../lib/utils/shared-formula.js","name":"colStr","original":{"line":22,"column":34},"generated":{"line":25,"column":31}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":22,"column":40},"generated":{"line":25,"column":37}},{"source":"../../../lib/utils/shared-formula.js","name":"length","original":{"line":22,"column":41},"generated":{"line":25,"column":38}},{"source":"../../../lib/utils/shared-formula.js","name":"colStr","original":{"line":22,"column":34},"generated":{"line":25,"column":44}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":22,"column":52},"generated":{"line":25,"column":49}},{"source":"../../../lib/utils/shared-formula.js","name":"colStr","original":{"line":22,"column":34},"generated":{"line":25,"column":50}},{"source":"../../../lib/utils/shared-formula.js","name":"colStr","original":{"line":22,"column":57},"generated":{"line":25,"column":54}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":22,"column":63},"generated":{"line":25,"column":60}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":22,"column":66},"generated":{"line":25,"column":63}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":22,"column":8},"generated":{"line":25,"column":68}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":22,"column":74},"generated":{"line":25,"column":70}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":23,"column":10},"generated":{"line":26,"column":8}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":24,"column":10},"generated":{"line":27,"column":8}},{"source":"../../../lib/utils/shared-formula.js","name":"refMatch","original":{"line":24,"column":17},"generated":{"line":27,"column":15}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":24,"column":10},"generated":{"line":27,"column":23}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":25,"column":9},"generated":{"line":28,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":26,"column":8},"generated":{"line":30,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"col","original":{"line":26,"column":12},"generated":{"line":30,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":26,"column":15},"generated":{"line":30,"column":13}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":26,"column":18},"generated":{"line":30,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":26,"column":26},"generated":{"line":30,"column":24}},{"source":"../../../lib/utils/shared-formula.js","name":"l2n","original":{"line":26,"column":27},"generated":{"line":30,"column":25}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":26,"column":18},"generated":{"line":30,"column":28}},{"source":"../../../lib/utils/shared-formula.js","name":"colStr","original":{"line":26,"column":31},"generated":{"line":30,"column":29}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":26,"column":18},"generated":{"line":30,"column":35}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":26,"column":8},"generated":{"line":30,"column":36}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":27,"column":8},"generated":{"line":31,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"row","original":{"line":27,"column":12},"generated":{"line":31,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":27,"column":15},"generated":{"line":31,"column":13}},{"source":"../../../lib/utils/shared-formula.js","name":"parseInt","original":{"line":27,"column":18},"generated":{"line":31,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":27,"column":26},"generated":{"line":31,"column":24}},{"source":"../../../lib/utils/shared-formula.js","name":"rowStr","original":{"line":27,"column":27},"generated":{"line":31,"column":25}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":27,"column":26},"generated":{"line":31,"column":31}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":27,"column":35},"generated":{"line":31,"column":33}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":27,"column":26},"generated":{"line":31,"column":35}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":27,"column":8},"generated":{"line":31,"column":36}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":28,"column":8},"generated":{"line":33,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":28,"column":12},"generated":{"line":33,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":"colDollar","original":{"line":28,"column":13},"generated":{"line":33,"column":11}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":28,"column":8},"generated":{"line":33,"column":20}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":28,"column":24},"generated":{"line":33,"column":22}},{"source":"../../../lib/utils/shared-formula.js","name":"col","original":{"line":29,"column":10},"generated":{"line":34,"column":8}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":29,"column":13},"generated":{"line":34,"column":11}},{"source":"../../../lib/utils/shared-formula.js","name":"to","original":{"line":29,"column":17},"generated":{"line":34,"column":15}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":29,"column":19},"generated":{"line":34,"column":17}},{"source":"../../../lib/utils/shared-formula.js","name":"col","original":{"line":29,"column":20},"generated":{"line":34,"column":18}},{"source":"../../../lib/utils/shared-formula.js","name":"to","original":{"line":29,"column":17},"generated":{"line":34,"column":21}},{"source":"../../../lib/utils/shared-formula.js","name":"offset","original":{"line":29,"column":26},"generated":{"line":34,"column":24}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":29,"column":32},"generated":{"line":34,"column":30}},{"source":"../../../lib/utils/shared-formula.js","name":"col","original":{"line":29,"column":33},"generated":{"line":34,"column":31}},{"source":"../../../lib/utils/shared-formula.js","name":"col","original":{"line":29,"column":10},"generated":{"line":34,"column":34}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":30,"column":9},"generated":{"line":35,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":31,"column":8},"generated":{"line":37,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":31,"column":12},"generated":{"line":37,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":"rowDollar","original":{"line":31,"column":13},"generated":{"line":37,"column":11}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":31,"column":8},"generated":{"line":37,"column":20}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":31,"column":24},"generated":{"line":37,"column":22}},{"source":"../../../lib/utils/shared-formula.js","name":"row","original":{"line":32,"column":10},"generated":{"line":38,"column":8}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":32,"column":13},"generated":{"line":38,"column":11}},{"source":"../../../lib/utils/shared-formula.js","name":"to","original":{"line":32,"column":17},"generated":{"line":38,"column":15}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":32,"column":19},"generated":{"line":38,"column":17}},{"source":"../../../lib/utils/shared-formula.js","name":"row","original":{"line":32,"column":20},"generated":{"line":38,"column":18}},{"source":"../../../lib/utils/shared-formula.js","name":"to","original":{"line":32,"column":17},"generated":{"line":38,"column":21}},{"source":"../../../lib/utils/shared-formula.js","name":"offset","original":{"line":32,"column":26},"generated":{"line":38,"column":24}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":32,"column":32},"generated":{"line":38,"column":30}},{"source":"../../../lib/utils/shared-formula.js","name":"row","original":{"line":32,"column":33},"generated":{"line":38,"column":31}},{"source":"../../../lib/utils/shared-formula.js","name":"row","original":{"line":32,"column":10},"generated":{"line":38,"column":34}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":33,"column":9},"generated":{"line":39,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":8},"generated":{"line":41,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"res","original":{"line":34,"column":14},"generated":{"line":41,"column":10}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":17},"generated":{"line":41,"column":13}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":20},"generated":{"line":41,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":"sheet","original":{"line":34,"column":21},"generated":{"line":41,"column":17}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":26},"generated":{"line":41,"column":22}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":30},"generated":{"line":41,"column":26}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":20},"generated":{"line":41,"column":28}},{"source":"../../../lib/utils/shared-formula.js","name":"colDollar","original":{"line":34,"column":37},"generated":{"line":41,"column":33}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":46},"generated":{"line":41,"column":42}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":50},"generated":{"line":41,"column":46}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":20},"generated":{"line":41,"column":48}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":34,"column":56},"generated":{"line":41,"column":52}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":64},"generated":{"line":41,"column":60}},{"source":"../../../lib/utils/shared-formula.js","name":"n2l","original":{"line":34,"column":65},"generated":{"line":41,"column":61}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":34,"column":56},"generated":{"line":41,"column":64}},{"source":"../../../lib/utils/shared-formula.js","name":"col","original":{"line":34,"column":69},"generated":{"line":41,"column":65}},{"source":"../../../lib/utils/shared-formula.js","name":"colCache","original":{"line":34,"column":56},"generated":{"line":41,"column":68}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":20},"generated":{"line":41,"column":69}},{"source":"../../../lib/utils/shared-formula.js","name":"rowDollar","original":{"line":34,"column":77},"generated":{"line":41,"column":73}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":86},"generated":{"line":41,"column":82}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":90},"generated":{"line":41,"column":86}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":20},"generated":{"line":41,"column":88}},{"source":"../../../lib/utils/shared-formula.js","name":"row","original":{"line":34,"column":96},"generated":{"line":41,"column":92}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":34,"column":8},"generated":{"line":41,"column":95}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":35,"column":8},"generated":{"line":42,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"res","original":{"line":35,"column":15},"generated":{"line":42,"column":13}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":35,"column":8},"generated":{"line":42,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":36,"column":7},"generated":{"line":43,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":37,"column":6},"generated":{"line":45,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":"refMatch","original":{"line":37,"column":13},"generated":{"line":45,"column":11}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":37,"column":6},"generated":{"line":45,"column":19}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":10,"column":9},"generated":{"line":46,"column":2}},{"source":"../../../lib/utils/shared-formula.js","name":"formula","original":{"line":10,"column":9},"generated":{"line":46,"column":3}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":10,"column":2},"generated":{"line":46,"column":4}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":40,"column":1},"generated":{"line":47,"column":0}},{"source":"../../../lib/utils/shared-formula.js","name":"module","original":{"line":42,"column":0},"generated":{"line":49,"column":0}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":42,"column":6},"generated":{"line":49,"column":6}},{"source":"../../../lib/utils/shared-formula.js","name":"exports","original":{"line":42,"column":7},"generated":{"line":49,"column":7}},{"source":"../../../lib/utils/shared-formula.js","name":"module","original":{"line":42,"column":0},"generated":{"line":49,"column":14}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":42,"column":17},"generated":{"line":49,"column":17}},{"source":"../../../lib/utils/shared-formula.js","name":"slideFormula","original":{"line":43,"column":2},"generated":{"line":50,"column":2}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":43,"column":14},"generated":{"line":50,"column":14}},{"source":"../../../lib/utils/shared-formula.js","name":"slideFormula","original":{"line":43,"column":2},"generated":{"line":50,"column":16}},{"source":"../../../lib/utils/shared-formula.js","name":null,"original":{"line":42,"column":17},"generated":{"line":51,"column":0}},{"source":"../../../lib/utils/shared-formula.js","name":"module","original":{"line":42,"column":0},"generated":{"line":51,"column":1}}],"sources":{"../../../lib/utils/shared-formula.js":"const colCache = require('./col-cache');\r\n\r\n// const cellRefRegex = /(([a-z_\\-0-9]*)!)?[$]?([a-z]+)[$]?([1-9][0-9]*)/i;\r\nconst replacementCandidateRx = /(([a-z_\\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi;\r\nconst CRrx = /^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;\r\n\r\nfunction slideFormula(formula, fromCell, toCell) {\r\n  const offset = colCache.decode(fromCell);\r\n  const to = colCache.decode(toCell);\r\n  return formula.replace(\r\n    replacementCandidateRx,\r\n    (refMatch, sheet, sheetMaybe, addrPart, trailingParen) => {\r\n      if (trailingParen) {\r\n        return refMatch;\r\n      }\r\n      const match = CRrx.exec(addrPart);\r\n      if (match) {\r\n        const colDollar = match[1];\r\n        const colStr = match[2].toUpperCase();\r\n        const rowDollar = match[3];\r\n        const rowStr = match[4];\r\n        if (colStr.length > 3 || (colStr.length === 3 && colStr > 'XFD')) {\r\n          // > XFD is the highest col number in excel 2007 and beyond, so this is a named range\r\n          return refMatch;\r\n        }\r\n        let col = colCache.l2n(colStr);\r\n        let row = parseInt(rowStr, 10);\r\n        if (!colDollar) {\r\n          col += to.col - offset.col;\r\n        }\r\n        if (!rowDollar) {\r\n          row += to.row - offset.row;\r\n        }\r\n        const res = (sheet || '') + (colDollar || '') + colCache.n2l(col) + (rowDollar || '') + row;\r\n        return res;\r\n      }\r\n      return refMatch;\r\n    }\r\n  );\r\n}\r\n\r\nmodule.exports = {\r\n  slideFormula,\r\n};\r\n"},"lineCount":null}},"error":null,"hash":"5b5bbf574cb66a5ee99f3a45b44c9ac8","cacheData":{"env":{}}}